# cluster/apps/vpn/networking.yaml
apiVersion: v1
kind: Service
metadata:
  name: wg-easy
  namespace: vpn
spec:
  type: LoadBalancer
  loadBalancerIP: 192.168.1.47
  ports:
    - name: wireguard
      port: 51820
      targetPort: 51820
      protocol: UDP
    - name: web
      port: 51821
      targetPort: 51821
      protocol: TCP
  selector:
    app: wg-easy
---
apiVersion: traefik.io/v1alpha1
kind: IngressRoute
metadata:
  name: wg-easy
  namespace: vpn
spec:
  entryPoints:
    - web
  routes:
    - match: Host(`wg.homelab.local`)
      kind: Rule
      services:
        - name: wg-easy
          port: 51821 